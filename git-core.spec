%include	/usr/lib/rpm/macros.perl
Summary:	The stupid content tracker
Summary(pl):	Prymitywne narzêdzie do ¶ledzenia tre¶ci
Name:		git-core
Version:	1.4.3.4
Release:	2
License:	GPL v2
Group:		Development/Tools
Source0:	http://www.kernel.org/pub/software/scm/git/git-%{version}.tar.bz2
# Source0-md5:	5114c6b58329f3574697a595774df7d0
URL:		http://git.or.cz/
BuildRequires:	asciidoc
BuildRequires:	curl-devel
BuildRequires:	expat-devel
BuildRequires:	openssl-devel
BuildRequires:	perl-Error
BuildRequires:	perl-base
BuildRequires:	python
BuildRequires:	rpm-perlprov >= 4.1-13
BuildRequires:	xmlto
BuildRequires:	zlib-devel
BuildRoot:	%{tmpdir}/%{name}-%{version}-root-%(id -u -n)

%description
"git" can mean anything, depending on your mood.

 - random three-letter combination that is pronounceable, and not
   actually used by any common UNIX command. The fact that it is a
   mispronunciation of "get" may or may not be relevant.
 - stupid. contemptible and despicable. simple. Take your pick from the
   dictionary of slang.
 - "global information tracker": you're in a good mood, and it actually
   works for you. Angels sing, and a light suddenly fills the room.
 - "goddamn idiotic truckload of sh*t": when it breaks

This is a stupid (but extremely fast) directory content manager. It
doesn't do a whole lot, but what it 'does' do is track directory
contents efficiently.

%description -l pl
"git" mo¿e oznaczaæ cokolwiek, w zale¿no¶ci od nastroju.

- losow± kombinacjê trzech liter, która jest wymawialna i w³a¶ciwie
  nie u¿ywana przez ¿adne popularne polecenie uniksowe. Fakt, ¿e jest to
  b³êdna pisownia s³owa "get" mo¿e mieæ lub nie mieæ znaczenia.
- g³upi, pogardliwy, prosty. Mo¿na wybraæ ze s³ownika slangu.
- "global information tracker" (narzêdzie do globalnego ¶ledzenia
  informacji) - je¶li jeste¶my w dobrym nastroju i git akurat dzia³a.
  Anio³y ¶piewaj±, a ¶wiat³o niespodziewanie wype³nia pokój.
- "goddamn idiotic truckload of sh*t" (przeklêty idiotyczny ³adunek
  g*) - kiedy siê zepsuje.

Jest to prymitywny (ale bardzo szybki) zarz±dca tre¶ci s³ownikowej.
Nie robi wiele, ale to, co "robi", to wydajne ¶ledzenie zawarto¶ci
katalogu.

%package devel
Summary:	Header files for git-core
Summary(pl):	Pliki nag³ówkowe dla git-core
Group:		Development/Libraries

%description devel
Header files for git-core.

%description devel
Pliki nag³ówkowe dla git-core.

%package -n perl-Git
Summary:	Perl interface to the Git version control system
Summary(pl):	Perlowy interfejs do systemu kontroli wersji Git
Group:		Development/Languages/Perl
Requires:	%{name} = %{version}-%{release}
Obsoletes:	perl-git-core

%description -n perl-Git
This module provides Perl scripts easy way to interface the Git
version control system. The modules have an easy and well-tested way
to call arbitrary Git commands; in the future, the interface will also
provide specialized methods for doing easily operations which are not
totally trivial to do over the generic command interface.

%description -n perl-Git -l pl
Ten modu³ umo¿liwia skryptom Perla wspó³pracê z systemem kontroli
wersji Git. W ³atwy i dobrze przetestowany sposób pozwala wywo³ywaæ
dowolne polecenia Gita; w przysz³o¶ci interfejs udostêpni tak¿e
specjalne metody do ³atwego wykonywania operacji nietrywialnych do
wykonania przy u¿yciu ogólnego interfejsu poleceñ.

%prep
%setup -q -n git-%{version}

%build
%{__make} \
	prefix=%{_prefix} \
	CC="%{__cc}" \
	CFLAGS="%{rpmcflags}" \
	LDFLAGS="%{rpmldflags}"

# once again to get perl paths stright
cd perl
%{__perl} Makefile.PL \
	INSTALLDIRS=vendor
%{__make}
cd ..

%{__make} -C Documentation

%install
rm -rf $RPM_BUILD_ROOT
install -d $RPM_BUILD_ROOT%{_includedir}/%{name}/xdiff

%{__make} install \
	prefix=%{_prefix} \
	CFLAGS="%{rpmcflags}" \
	DESTDIR=$RPM_BUILD_ROOT

%{__make} -C Documentation install \
	prefix=%{_prefix} \
	mandir=%{_mandir} \
	DESTDIR=$RPM_BUILD_ROOT

install *.h $RPM_BUILD_ROOT%{_includedir}/%{name}
install xdiff/*.h $RPM_BUILD_ROOT%{_includedir}/%{name}/xdiff

rm -f $RPM_BUILD_ROOT%{perl_archlib}/perllocal.pod
rm -f $RPM_BUILD_ROOT%{perl_vendorarch}/auto/Git/.packlist

%clean
rm -rf $RPM_BUILD_ROOT

%files
%defattr(644,root,root,755)
%doc README Documentation/*.html Documentation/howto Documentation/technical
%attr(755,root,root) %{_bindir}/*
%{_mandir}/man*/*
%dir %{_datadir}/%{name}
%{_datadir}/%{name}/*

%files devel
%defattr(644,root,root,755)
%{_includedir}/*

%files -n perl-Git
%defattr(644,root,root,755)
%{perl_vendorlib}/Git.pm
%{_mandir}/man3/*
